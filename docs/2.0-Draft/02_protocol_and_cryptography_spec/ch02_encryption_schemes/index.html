
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="../../01_use_case_model/ch03_use_cases/" rel="prev"/>
<link href="../ch03_container_format/" rel="next"/>
<link href="../../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.5.50" name="generator"/>
<title>3. CDOC2 encryption schemes - CDOC2 System Documentation</title>
<link href="../../assets/stylesheets/main.a40c8224.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css" rel="stylesheet"/>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#cdoc2-encryption-schemes">4. 
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<div data-md-color-scheme="default" data-md-component="outdated" hidden="">
</div>
<header class="md-header md-header--shadow" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="CDOC2 System Documentation" class="md-header__button md-logo" data-md-component="logo" href="../.." title="CDOC2 System Documentation">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            CDOC2 System Documentation
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              3. CDOC2 encryption schemes
            
          </span>
</div>
</div>
</div>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="CDOC2 System Documentation" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="CDOC2 System Documentation">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
    CDOC2 System Documentation
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../..">
<span class="md-ellipsis">
    Introduction
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
<span class="md-ellipsis">
    Use Case Model
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            Use Case Model
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../01_use_case_model/ch03_use_cases/">
<span class="md-ellipsis">
    Use Cases
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
<span class="md-ellipsis">
    Protocol and Cryptography Specification
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
            Protocol and Cryptography Specification
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    Encryption Schemes
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    Encryption Schemes
  </span>
</a>
<nav aria-label="In this chapter:" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      In this chapter:
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#introduction">
<span class="md-ellipsis">
      Introduction
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#notation-and-functions">
<span class="md-ellipsis">
      Notation and functions
    </span>
</a>
<nav aria-label="Notation and functions" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#notation">
<span class="md-ellipsis">
      Notation
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#standard-cryptographic-functions">
<span class="md-ellipsis">
      Standard cryptographic functions
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#generic-cdoc2-encryption-scheme">
<span class="md-ellipsis">
      Generic CDOC2 encryption scheme
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#encryption-schemes-with-key-establishment-algorithms">
<span class="md-ellipsis">
      Encryption schemes with key-establishment algorithms
    </span>
</a>
<nav aria-label="Encryption schemes with key-establishment algorithms" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#sc01-encryption-scheme-for-recipients-with-ec-key-pair">
<span class="md-ellipsis">
      SC01: Encryption scheme for Recipients with EC key pair
    </span>
</a>
<nav aria-label="SC01: Encryption scheme for Recipients with EC key pair" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#encryption-steps-by-sender">
<span class="md-ellipsis">
      Encryption steps by Sender
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#decryption-steps-by-recipients">
<span class="md-ellipsis">
      Decryption steps by Recipients
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#encryption-schemes-with-asymmetric-public-key-encryption-system">
<span class="md-ellipsis">
      Encryption schemes with asymmetric public key encryption system
    </span>
</a>
<nav aria-label="Encryption schemes with asymmetric public key encryption system" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#sc02-encryption-scheme-for-recipients-with-rsa-key-pair">
<span class="md-ellipsis">
      SC02: Encryption scheme for recipients with RSA key pair
    </span>
</a>
<nav aria-label="SC02: Encryption scheme for recipients with RSA key pair" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#encryption-steps-by-sender_1">
<span class="md-ellipsis">
      Encryption steps by Sender
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#decryption-steps-by-recipients_1">
<span class="md-ellipsis">
      Decryption steps by Recipients
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#encryption-schemes-using-capsule-servers">
<span class="md-ellipsis">
      Encryption schemes using Capsule Servers
    </span>
</a>
<nav aria-label="Encryption schemes using Capsule Servers" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#sc03-encryption-scheme-with-capsule-server-for-recipients-with-ec-key-pairs">
<span class="md-ellipsis">
      SC03: Encryption scheme with capsule server for recipients with EC key pairs
    </span>
</a>
<nav aria-label="SC03: Encryption scheme with capsule server for recipients with EC key pairs" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#encryption-steps-by-sender_2">
<span class="md-ellipsis">
      Encryption steps by Sender
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#decryption-steps-by-recipients_2">
<span class="md-ellipsis">
      Decryption steps by Recipients
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#sc04-encryption-scheme-with-capsule-server-for-recipients-with-rsa-key-pairs">
<span class="md-ellipsis">
      SC04: Encryption scheme with Capsule Server for recipients with RSA key pairs
    </span>
</a>
<nav aria-label="SC04: Encryption scheme with Capsule Server for recipients with RSA key pairs" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#encryption-steps-by-sender_3">
<span class="md-ellipsis">
      Encryption steps by Sender
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#decryption-steps-by-recipients_3">
<span class="md-ellipsis">
      Decryption steps by Recipients
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#encryption-schemes-with-pre-shared-secrets">
<span class="md-ellipsis">
      Encryption schemes with pre-shared secrets
    </span>
</a>
<nav aria-label="Encryption schemes with pre-shared secrets" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#sc05-encryption-scheme-for-recipients-with-pre-shared-symmetric-secret">
<span class="md-ellipsis">
      SC05: Encryption scheme for recipients with pre-shared symmetric secret
    </span>
</a>
<nav aria-label="SC05: Encryption scheme for recipients with pre-shared symmetric secret" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#encryption-steps-by-sender_4">
<span class="md-ellipsis">
      Encryption steps by Sender
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#decryption-steps-for-recipients-or-sender">
<span class="md-ellipsis">
      Decryption steps for Recipients or Sender
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#sc06-direct-encryption-scheme-with-pre-shared-passwords">
<span class="md-ellipsis">
      SC06: Direct encryption scheme with pre-shared passwords
    </span>
</a>
<nav aria-label="SC06: Direct encryption scheme with pre-shared passwords" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#encryption-steps-by-sender_5">
<span class="md-ellipsis">
      Encryption steps by Sender
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#decryption-steps-for-recipient-or-sender">
<span class="md-ellipsis">
      Decryption steps for Recipient or Sender
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#encryption-schemes-with-secret-sharing">
<span class="md-ellipsis">
      Encryption schemes with secret sharing
    </span>
</a>
<nav aria-label="Encryption schemes with secret sharing" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#sc07-encryption-scheme-with-n-of-n-secret-shared-decryption-key">
<span class="md-ellipsis">
      SC07: Encryption scheme with (n-of-n) secret shared decryption key
    </span>
</a>
<nav aria-label="SC07: Encryption scheme with (n-of-n) secret shared decryption key" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#encryption-steps-by-sender_6">
<span class="md-ellipsis">
      Encryption steps by Sender
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#decryption-steps-by-recipient">
<span class="md-ellipsis">
      Decryption steps by Recipient
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../ch03_container_format/">
<span class="md-ellipsis">
    Container Format
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../ch05_cryptographic_details/">
<span class="md-ellipsis">
    Cryptographic Details
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../appendix_a_header_fbs/">
<span class="md-ellipsis">
    Appendix A: header.fbs
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../appendix_b_recipients_fbs/">
<span class="md-ellipsis">
    Appendix B: recipients.fbs
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../appendix_c_cdoc2-capsules/">
<span class="md-ellipsis">
    Appendix C: Capsules API
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../appendix_d_keylabel/">
<span class="md-ellipsis">
    Appendix D: KeyLabel field specification
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../appendix_e_cdoc2-shares/">
<span class="md-ellipsis">
    Appendix E: Key Shares API
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
<span class="md-ellipsis">
    System Architecture
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            System Architecture
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../03_system_architecture/ch01_system_context/">
<span class="md-ellipsis">
    System Context
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../03_system_architecture/ch02_system_components/">
<span class="md-ellipsis">
    System Components
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../03_system_architecture/ch03_external_interfaces/">
<span class="md-ellipsis">
    External Interfaces
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../03_system_architecture/ch04_capsule_server/">
<span class="md-ellipsis">
    Capsule Server
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../03_system_architecture/ch05_shares_server/">
<span class="md-ellipsis">
    Shares Server
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../03_system_architecture/ch06_ID_authentication_protocol/">
<span class="md-ellipsis">
    Client authentication protocol
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
<span class="md-ellipsis">
    Test Plan
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
            Test Plan
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../04_test_plan/test_plan/">
<span class="md-ellipsis">
    Capsule Server Test Plan
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
<span class="md-ellipsis">
    User Guides
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
            User Guides
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../08_User_Guides/password_guide/">
<span class="md-ellipsis">
    Password Strength User Guide
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../08_User_Guides/parooli_juhend/">
<span class="md-ellipsis">
    Parooli juhend
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../08_User_Guides/container_storage_guide/">
<span class="md-ellipsis">
    CDOC2 Container Storage User Guide
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../08_User_Guides/konteineri_s%C3%A4ilitamise_juhend/">
<span class="md-ellipsis">
    CDOC2 konteineri säilitamise juhend
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../08_User_Guides/overview_diagrams/">
<span class="md-ellipsis">
    Overview diagrams
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
<span class="md-ellipsis">
    Appendixes
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_7_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_7">
<span class="md-nav__icon md-icon"></span>
            Appendixes
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../09_Appendixes/A1_Security_level/">
<span class="md-ellipsis">
    Appendix 1: Security level
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="In this chapter:" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      In this chapter:
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#introduction">
<span class="md-ellipsis">
      Introduction
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#notation-and-functions">
<span class="md-ellipsis">
      Notation and functions
    </span>
</a>
<nav aria-label="Notation and functions" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#notation">
<span class="md-ellipsis">
      Notation
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#standard-cryptographic-functions">
<span class="md-ellipsis">
      Standard cryptographic functions
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#generic-cdoc2-encryption-scheme">
<span class="md-ellipsis">
      Generic CDOC2 encryption scheme
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#encryption-schemes-with-key-establishment-algorithms">
<span class="md-ellipsis">
      Encryption schemes with key-establishment algorithms
    </span>
</a>
<nav aria-label="Encryption schemes with key-establishment algorithms" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#sc01-encryption-scheme-for-recipients-with-ec-key-pair">
<span class="md-ellipsis">
      SC01: Encryption scheme for Recipients with EC key pair
    </span>
</a>
<nav aria-label="SC01: Encryption scheme for Recipients with EC key pair" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#encryption-steps-by-sender">
<span class="md-ellipsis">
      Encryption steps by Sender
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#decryption-steps-by-recipients">
<span class="md-ellipsis">
      Decryption steps by Recipients
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#encryption-schemes-with-asymmetric-public-key-encryption-system">
<span class="md-ellipsis">
      Encryption schemes with asymmetric public key encryption system
    </span>
</a>
<nav aria-label="Encryption schemes with asymmetric public key encryption system" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#sc02-encryption-scheme-for-recipients-with-rsa-key-pair">
<span class="md-ellipsis">
      SC02: Encryption scheme for recipients with RSA key pair
    </span>
</a>
<nav aria-label="SC02: Encryption scheme for recipients with RSA key pair" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#encryption-steps-by-sender_1">
<span class="md-ellipsis">
      Encryption steps by Sender
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#decryption-steps-by-recipients_1">
<span class="md-ellipsis">
      Decryption steps by Recipients
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#encryption-schemes-using-capsule-servers">
<span class="md-ellipsis">
      Encryption schemes using Capsule Servers
    </span>
</a>
<nav aria-label="Encryption schemes using Capsule Servers" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#sc03-encryption-scheme-with-capsule-server-for-recipients-with-ec-key-pairs">
<span class="md-ellipsis">
      SC03: Encryption scheme with capsule server for recipients with EC key pairs
    </span>
</a>
<nav aria-label="SC03: Encryption scheme with capsule server for recipients with EC key pairs" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#encryption-steps-by-sender_2">
<span class="md-ellipsis">
      Encryption steps by Sender
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#decryption-steps-by-recipients_2">
<span class="md-ellipsis">
      Decryption steps by Recipients
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#sc04-encryption-scheme-with-capsule-server-for-recipients-with-rsa-key-pairs">
<span class="md-ellipsis">
      SC04: Encryption scheme with Capsule Server for recipients with RSA key pairs
    </span>
</a>
<nav aria-label="SC04: Encryption scheme with Capsule Server for recipients with RSA key pairs" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#encryption-steps-by-sender_3">
<span class="md-ellipsis">
      Encryption steps by Sender
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#decryption-steps-by-recipients_3">
<span class="md-ellipsis">
      Decryption steps by Recipients
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#encryption-schemes-with-pre-shared-secrets">
<span class="md-ellipsis">
      Encryption schemes with pre-shared secrets
    </span>
</a>
<nav aria-label="Encryption schemes with pre-shared secrets" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#sc05-encryption-scheme-for-recipients-with-pre-shared-symmetric-secret">
<span class="md-ellipsis">
      SC05: Encryption scheme for recipients with pre-shared symmetric secret
    </span>
</a>
<nav aria-label="SC05: Encryption scheme for recipients with pre-shared symmetric secret" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#encryption-steps-by-sender_4">
<span class="md-ellipsis">
      Encryption steps by Sender
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#decryption-steps-for-recipients-or-sender">
<span class="md-ellipsis">
      Decryption steps for Recipients or Sender
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#sc06-direct-encryption-scheme-with-pre-shared-passwords">
<span class="md-ellipsis">
      SC06: Direct encryption scheme with pre-shared passwords
    </span>
</a>
<nav aria-label="SC06: Direct encryption scheme with pre-shared passwords" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#encryption-steps-by-sender_5">
<span class="md-ellipsis">
      Encryption steps by Sender
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#decryption-steps-for-recipient-or-sender">
<span class="md-ellipsis">
      Decryption steps for Recipient or Sender
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#encryption-schemes-with-secret-sharing">
<span class="md-ellipsis">
      Encryption schemes with secret sharing
    </span>
</a>
<nav aria-label="Encryption schemes with secret sharing" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#sc07-encryption-scheme-with-n-of-n-secret-shared-decryption-key">
<span class="md-ellipsis">
      SC07: Encryption scheme with (n-of-n) secret shared decryption key
    </span>
</a>
<nav aria-label="SC07: Encryption scheme with (n-of-n) secret shared decryption key" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#encryption-steps-by-sender_6">
<span class="md-ellipsis">
      Encryption steps by Sender
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#decryption-steps-by-recipient">
<span class="md-ellipsis">
      Decryption steps by Recipient
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="cdoc2-encryption-schemes"><span class="enumerate-headings-plugin enumerate-heading-plugin">4.</span> CDOC2 encryption schemes<a class="headerlink" href="#cdoc2-encryption-schemes" title="Permanent link">¶</a></h1>
<h2 id="introduction"><span class="enumerate-headings-plugin enumerate-heading-plugin">4.1</span> Introduction<a class="headerlink" href="#introduction" title="Permanent link">¶</a></h2>
<p>This section discusses encryption schemes, which are supported by CDOC2 system. The purpose of the section is to familiarize the reader with basic principles of encryption schemes and to specify, how the cryptographic primitives and other functions are used to compose CDOC2 encryption schemes. However, in this section, encryption schemes are presented in abstract form, and they are missing some details. For example, iteration count of PBKDF2 function is not defined here and additional arguments for the HKDF functions are not defined in this section. Such implementation details are specified in <a href="../ch05_cryptographic_details/">Cryptographic protocol details</a>.</p>
<p>Encryption schemes are presented in an abstract form, where Sender wants to send a message <code>M</code> (payload of the CDOC2 Container) to total of <code>l</code> Recipients (<code>Recipient_1</code>, <code>Recipient_2</code>, ... <code>Recipient_l</code>) and Recipients are all similar, in a sense that they all have similar RSA key pairs or that they all have established a password with Sender. In the actual CDOC2 system, Sender may mix different kind of Recipients and different encryption schemes may be concurrently used in the same CDOC2 Container. In that sense, encryption schemes defined in this section are not comparable to use-cases, which describe interaction details of user and CDOC2 system software components. Use-cases are discussed in section <a href="../../01_use_case_model/ch03_use_cases/">Client Application use cases</a>.</p>
<h2 id="notation-and-functions"><span class="enumerate-headings-plugin enumerate-heading-plugin">4.2</span> Notation and functions<a class="headerlink" href="#notation-and-functions" title="Permanent link">¶</a></h2>
<h3 id="notation"><span class="enumerate-headings-plugin enumerate-heading-plugin">4.2.1</span> Notation<a class="headerlink" href="#notation" title="Permanent link">¶</a></h3>
<p>For convenience, we repeat here some of the acronyms and shorthand notation, which is used to define cryptographic schemes:</p>
<ul>
<li><code>M</code> - Message (payload of CDOC2 Container)</li>
<li><code>C</code> - Ciphertext (encrypted message M)</li>
<li><code>FMK</code> - File Master Key. Cryptographic key material for deriving other encryption and HMAC keys.</li>
<li><code>CEK</code> - Content Encryption Key. Symmetric key used to encrypt the payload of CDOC2 Container.</li>
<li><code>KEK</code> - Key Encryption Key. Symmetric key used to encrypt (wrap) the FMK, so that FMK could be transmitted inside CDOC2 Capsule (CKC).</li>
<li>Index <code>i</code> is used to denote an instance of key or data structure, which is specific to certain Recipient, for example, <code>KEK_i</code>.</li>
</ul>
<h3 id="standard-cryptographic-functions"><span class="enumerate-headings-plugin enumerate-heading-plugin">4.2.2</span> Standard cryptographic functions<a class="headerlink" href="#standard-cryptographic-functions" title="Permanent link">¶</a></h3>
<p>Schemes use following standard functions:</p>
<ol>
<li><code>Enc(CEK, M)</code> means encryption of message <code>M</code> with symmetric key <code>CEK</code>.</li>
<li><code>HKDF()</code>, <code>HKDF-Extract()</code>, <code>HKDF-Expand()</code> are key derivation functions as defined in RFC5869 (<a href="https://datatracker.ietf.org/doc/html/rfc5869">https://datatracker.ietf.org/doc/html/rfc5869</a>).</li>
<li><code>ECSVDP-DH(SecretKey, PublicKey)</code> is Elliptic Curve Secret Value Derivation Primitive, Diffie-Hellman version, as defined in IEEE standard P1363 and in RFC5349 (<a href="https://datatracker.ietf.org/doc/html/rfc5349">https://datatracker.ietf.org/doc/html/rfc5349</a>). Note that this is little-bit different from "ECC Cofactor Diffie-Hellman (ECC CDH)" as defined in NIST SP800-56A, section 5.7.1.2.</li>
<li><code>RSAES-OAEP-ENCRYPT(PK, M)</code> means encryption of message <code>M</code> with RSA public key <code>PK</code> according to RFC8017, section 7.1.1 (<a href="https://datatracker.ietf.org/doc/html/rfc8017#section-7.1.1">https://datatracker.ietf.org/doc/html/rfc8017#section-7.1.1</a>).</li>
<li><code>RSAES-OAEP-DECRYPT(SK, C)</code> means decryption of ciphertext <code>C</code> with RSA private key <code>SK</code> according to RFC8017, section 7.1.2 (<a href="https://datatracker.ietf.org/doc/html/rfc8017#section-7.1.2">https://datatracker.ietf.org/doc/html/rfc8017#section-7.1.2</a>)</li>
<li><code>PBKDF2(Password, Salt)</code> is key material derivation function as defined in RFC2898 (<a href="https://www.ietf.org/rfc/rfc2898.txt">https://www.ietf.org/rfc/rfc2898.txt</a>).</li>
<li><code>XOR(Key1, Key2)</code> is bitwise exclusive-or operation on symmetric keys.</li>
</ol>
<h2 id="generic-cdoc2-encryption-scheme"><span class="enumerate-headings-plugin enumerate-heading-plugin">4.3</span> Generic CDOC2 encryption scheme<a class="headerlink" href="#generic-cdoc2-encryption-scheme" title="Permanent link">¶</a></h2>
<p>In general, CDOC2 system implements encryption of payload of CDOC2 Container with the following generic steps:</p>
<ol>
<li>Sender generates a random FMK, which is used as a master key material for deriving other specific cryptographic keys.</li>
<li>From FMK, Sender derives a CEK, which is used for encrypting the payload of CDOC2 Container, and additional HMAC keys, which are used to protect the integrity of CDOC2 Container.</li>
<li>FMK is encrypted (wrapped) with a recipient-specific key encryption key (KEK) and added to the CDOC2 Container. It now depends on the capabilities of the Recipient, how this KEK is made available to Recipient, so that they could decrypt the encrypted FMK and in turn, the whole Container. For example, some Recipients may be able to use eID means, which are capable of Diffie-Hellman key exchange, some may be able to use authentication-only eID means and some may only be able to use pre-shared password.</li>
<li>Suitable encryption scheme for each Recipient is used and required information to execute key-establishment protocol or key-derivation protocol is put into data structure called "capsule" (Capsule). In some cases, the Capsule is transmitted along the CDOC2 Container itself and in some cases, Capsule Server(s) could be used.</li>
</ol>
<p>An example activity diagram about creating CDOC2 Container with multiple recipients, is given below:</p>
<p><img alt="uml diagram" class="uml" src="data:image/png;base64,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" title="Example diagram about creating CDOC2 Container with multiple recipients"/></p>
<h2 id="encryption-schemes-with-key-establishment-algorithms"><span class="enumerate-headings-plugin enumerate-heading-plugin">4.4</span> Encryption schemes with key-establishment algorithms<a class="headerlink" href="#encryption-schemes-with-key-establishment-algorithms" title="Permanent link">¶</a></h2>
<p>These schemes are usable in case Recipients have eID means with some type of asymmetric key pair (such as RSA or EC), and this key pair could be used do derive the FMK decryption key (KEK) between Sender and Recipient, with some kind of key-establishment protocol. CDOC2 Container will contain the encrypted payload and capsule, which contains necessary information to execute the key-establishment protocol. Container and capsule will be transmitted to Recipient in the same communication channel.</p>
<h3 id="sc01-encryption-scheme-for-recipients-with-ec-key-pair"><span class="enumerate-headings-plugin enumerate-heading-plugin">4.4.1</span> SC01: Encryption scheme for Recipients with EC key pair<a class="headerlink" href="#sc01-encryption-scheme-for-recipients-with-ec-key-pair" title="Permanent link">¶</a></h3>
<p>This scheme can be used for transmitting encrypted messages to Recipients holding an EC key pair. Scheme uses Diffie-Hellman key exchange algorithm to generate same secret value for both Sender and Recipient, which is used to protect the FMK of CDOC2 Container.</p>
<p>The key exchange algorithm is almost the same as NIST key-establishment scheme <code>C(1e, 1s, ECC CDH)</code> (SP 800-56A Rev3, Section 6.2.2.2 - "(Cofactor) One-Pass Diffie-Hellman, C(1e, 1s, ECC CDH) Scheme"), with the only difference that NIST describes a key-establishment scheme with cofactor ECC CDH primitive, but we are using ECC DH primitive without a cofactor.</p>
<h4 id="encryption-steps-by-sender"><span class="enumerate-headings-plugin enumerate-heading-plugin">4.4.1.1</span> Encryption steps by Sender<a class="headerlink" href="#encryption-steps-by-sender" title="Permanent link">¶</a></h4>
<p>Sender knows the ECC public keys <code>PK_1</code>, <code>PK_2</code>, ..., <code>PK_l</code> of recipients <code>B_1</code>, <code>B_2</code>, ..., <code>B_l</code>. Recipients hold corresponding ECC secret keys <code>SK_1</code>, <code>SK_2</code>, ..., <code>SK_l</code>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">FMK</span> <span class="o">=</span> <span class="n">HKDF</span><span class="o">-</span><span class="n">Extract</span><span class="p">(</span><span class="n">StaticFMKSalt</span><span class="p">,</span> <span class="n">CSRNG</span><span class="p">())</span>
<span class="n">CEK</span> <span class="o">=</span> <span class="n">HKDF</span><span class="o">-</span><span class="n">Expand</span><span class="p">(</span><span class="n">FMK</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">Enc</span><span class="p">(</span><span class="n">CEK</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
<span class="p">{</span><span class="n">EphemeralPK</span><span class="p">,</span> <span class="n">EphemeralSK</span><span class="p">}</span> <span class="o">=</span> <span class="n">CSRNG</span><span class="p">()</span>
<span class="n">KEK_i</span> <span class="o">=</span> <span class="n">HKDF</span><span class="p">(</span><span class="n">StaticKEKSalt</span><span class="p">,</span> <span class="n">ECSVDP</span><span class="o">-</span><span class="n">DH</span><span class="p">(</span><span class="n">EphemeralSK</span><span class="p">,</span> <span class="n">PK_i</span><span class="p">))</span>
<span class="n">Capsule_i</span> <span class="o">=</span> <span class="p">{</span><span class="n">EllipticCurveInfo</span><span class="p">,</span> <span class="n">EphemeralPK</span><span class="p">,</span> <span class="n">PK_i</span><span class="p">}</span>
<span class="n">EncryptedFMK_i</span> <span class="o">=</span> <span class="n">XOR</span><span class="p">(</span><span class="n">FMK</span><span class="p">,</span> <span class="n">KEK_i</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h4 id="decryption-steps-by-recipients"><span class="enumerate-headings-plugin enumerate-heading-plugin">4.4.1.2</span> Decryption steps by Recipients<a class="headerlink" href="#decryption-steps-by-recipients" title="Permanent link">¶</a></h4>
<p>Recipient <code>i</code> receives the CDOC2 <code>Container_i</code> with data <code>{C, EncryptedFMK_i, Capsule_i}</code> and has ECDSA public key <code>PK_i</code> and corresponding ECDSA secret key <code>SK_i</code>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">EncryptedFMK_i</span> <span class="o">=</span> <span class="n">Container_i</span><span class="o">.</span><span class="n">EncryptedFMK_i</span>
<span class="n">SenderEphemeralPK</span> <span class="o">=</span> <span class="n">Capsule_i</span><span class="o">.</span><span class="n">EphemeralPK</span>
<span class="n">KEK_i</span> <span class="o">=</span> <span class="n">HKDF</span><span class="p">(</span><span class="n">StaticKEKSalt</span><span class="p">,</span> <span class="n">ECSVDP</span><span class="o">-</span><span class="n">DH</span><span class="p">(</span><span class="n">SK_i</span><span class="p">,</span> <span class="n">EphemeralPK</span><span class="p">))</span>
<span class="n">FMK</span> <span class="o">=</span> <span class="n">XOR</span><span class="p">(</span><span class="n">KEK_i</span><span class="p">,</span> <span class="n">EncryptedFMK_i</span><span class="p">)</span>
<span class="n">CEK</span> <span class="o">=</span> <span class="n">HKDF</span><span class="o">-</span><span class="n">Expand</span><span class="p">(</span><span class="n">FMK</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Dec</span><span class="p">(</span><span class="n">CEK</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h2 id="encryption-schemes-with-asymmetric-public-key-encryption-system"><span class="enumerate-headings-plugin enumerate-heading-plugin">4.5</span> Encryption schemes with asymmetric public key encryption system<a class="headerlink" href="#encryption-schemes-with-asymmetric-public-key-encryption-system" title="Permanent link">¶</a></h2>
<h3 id="sc02-encryption-scheme-for-recipients-with-rsa-key-pair"><span class="enumerate-headings-plugin enumerate-heading-plugin">4.5.1</span> SC02: Encryption scheme for recipients with RSA key pair<a class="headerlink" href="#sc02-encryption-scheme-for-recipients-with-rsa-key-pair" title="Permanent link">¶</a></h3>
<p>This scheme can be used for transmitting encrypted messages to Recipients holding a RSA key pair. Scheme uses RSA-OAEP encryption scheme to protect the FMK decryption key (KEK). Wrapped KEK is included in the capsule, which is transmitted to the Recipient within the CDOC2 Container.</p>
<p>Note that, while it is also possible to use Diffie-Hellman key exchange algorithm with RSA key pair, in order to derive the KEK between Sender and Recipient, a direct RSAES-PKCS1-v1_5 or RSA-OAEP encryption scheme has been traditionally used with CDOC1 applications and therefore, support for this scheme has been carried over to CDOC2 system as well.</p>
<h4 id="encryption-steps-by-sender_1"><span class="enumerate-headings-plugin enumerate-heading-plugin">4.5.1.1</span> Encryption steps by Sender<a class="headerlink" href="#encryption-steps-by-sender_1" title="Permanent link">¶</a></h4>
<p>Sender knows the RSA public keys <code>PK_1</code>, <code>PK_2</code>, ..., <code>PK_l</code> of recipients <code>B_1</code>, <code>B_2</code>, ..., <code>B_l</code>. Recipients hold corresponding RSA secret keys <code>SK_1</code>, <code>SK_2</code>, ..., <code>SK_l</code>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">FMK</span> <span class="o">=</span> <span class="n">HKDF</span><span class="o">-</span><span class="n">Extract</span><span class="p">(</span><span class="n">StaticFMKSalt</span><span class="p">,</span> <span class="n">CSRNG</span><span class="p">())</span>
<span class="n">CEK</span> <span class="o">=</span> <span class="n">HKDF</span><span class="o">-</span><span class="n">Expand</span><span class="p">(</span><span class="n">FMK</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">Enc</span><span class="p">(</span><span class="n">CEK</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
<span class="n">KEK_i</span> <span class="o">=</span> <span class="n">CSRNG</span><span class="p">()</span>
<span class="n">EncryptedKEK_i</span> <span class="o">=</span> <span class="n">RSAES</span><span class="o">-</span><span class="n">OAEP</span><span class="o">-</span><span class="n">ENCRYPT</span><span class="p">(</span><span class="n">PK_i</span><span class="p">,</span> <span class="n">KEK_i</span><span class="p">)</span>
<span class="n">Capsule_i</span> <span class="o">=</span> <span class="p">{</span><span class="n">EncryptedKEK_i</span><span class="p">,</span> <span class="n">PK_i</span><span class="p">}</span>
<span class="n">EncryptedFMK_i</span> <span class="o">=</span> <span class="n">XOR</span><span class="p">(</span><span class="n">FMK</span><span class="p">,</span> <span class="n">KEK_i</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h4 id="decryption-steps-by-recipients_1"><span class="enumerate-headings-plugin enumerate-heading-plugin">4.5.1.2</span> Decryption steps by Recipients<a class="headerlink" href="#decryption-steps-by-recipients_1" title="Permanent link">¶</a></h4>
<p>Recipient <code>i</code> receives the CDOC2 <code>Container_i</code> with data <code>{C, EncryptedFMK_i, Capsule_i}</code> and has RSA public key <code>PK_i</code> and corresponding RSA secret key <code>SK_i</code>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">EncryptedFMK_i</span> <span class="o">=</span> <span class="n">Container_i</span><span class="o">.</span><span class="n">EncryptedFMK</span>
<span class="n">EncryptedKEK_i</span> <span class="o">=</span> <span class="n">Capsule_i</span><span class="o">.</span><span class="n">EncryptedKEK</span>
<span class="n">KEK_i</span> <span class="o">=</span> <span class="n">RSAES</span><span class="o">-</span><span class="n">OAEP</span><span class="o">-</span><span class="n">DECRYPT</span><span class="p">(</span><span class="n">SK_i</span><span class="p">,</span> <span class="n">EncryptedKEK_i</span><span class="p">)</span>
<span class="n">FMK</span> <span class="o">=</span> <span class="n">XOR</span><span class="p">(</span><span class="n">KEK_i</span><span class="p">,</span> <span class="n">EncryptedFMK_i</span><span class="p">)</span>
<span class="n">CEK</span> <span class="o">=</span> <span class="n">HKDF</span><span class="o">-</span><span class="n">Expand</span><span class="p">(</span><span class="n">FMK</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Dec</span><span class="p">(</span><span class="n">CEK</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h2 id="encryption-schemes-using-capsule-servers"><span class="enumerate-headings-plugin enumerate-heading-plugin">4.6</span> Encryption schemes using Capsule Servers<a class="headerlink" href="#encryption-schemes-using-capsule-servers" title="Permanent link">¶</a></h2>
<p>These schemes are usable, in case the Sender wishes to use Capsule Server as a separate transmission channel for sending key capsules to Recipients. CDOC2 Container itself is still transmitted within the usual transmission channel.</p>
<h3 id="sc03-encryption-scheme-with-capsule-server-for-recipients-with-ec-key-pairs"><span class="enumerate-headings-plugin enumerate-heading-plugin">4.6.1</span> SC03: Encryption scheme with capsule server for recipients with EC key pairs<a class="headerlink" href="#sc03-encryption-scheme-with-capsule-server-for-recipients-with-ec-key-pairs" title="Permanent link">¶</a></h3>
<p>This scheme uses same kind of key-establishment algorithm, as <a href="#sc01-encryption-scheme-for-recipients-with-ec-key-pair">scheme SC01</a>, but Capsule is transmitted via the Capsule Servers.</p>
<h4 id="encryption-steps-by-sender_2"><span class="enumerate-headings-plugin enumerate-heading-plugin">4.6.1.1</span> Encryption steps by Sender<a class="headerlink" href="#encryption-steps-by-sender_2" title="Permanent link">¶</a></h4>
<p>Sender knows the ECC public keys <code>PK_1</code>, <code>PK_2</code>, ..., <code>PK_l</code> of recipients <code>B_1</code>, <code>B_2</code>, ..., <code>B_l</code>. Recipients hold corresponding ECC secret keys <code>SK_1</code>, <code>SK_2</code>, ..., <code>SK_l</code>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">FMK</span> <span class="o">=</span> <span class="n">HKDF</span><span class="o">-</span><span class="n">Extract</span><span class="p">(</span><span class="n">StaticFMKSalt</span><span class="p">,</span> <span class="n">CSRNG</span><span class="p">())</span>
<span class="n">CEK</span> <span class="o">=</span> <span class="n">HKDF</span><span class="o">-</span><span class="n">Expand</span><span class="p">(</span><span class="n">FMK</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">Enc</span><span class="p">(</span><span class="n">CEK</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
<span class="p">{</span><span class="n">EphemeralPK</span><span class="p">,</span> <span class="n">EphemeralSK</span><span class="p">}</span> <span class="o">=</span> <span class="n">CSRNG</span><span class="p">()</span>
<span class="n">KEK_i</span> <span class="o">=</span> <span class="n">HKDF</span><span class="p">(</span><span class="n">StaticKEKSalt</span><span class="p">,</span> <span class="n">ECSVDP</span><span class="o">-</span><span class="n">DH</span><span class="p">(</span><span class="n">EphemeralSK</span><span class="p">,</span> <span class="n">PK_i</span><span class="p">))</span>
<span class="n">KeyServerCapsule_i</span> <span class="o">=</span> <span class="p">{</span><span class="n">EphemeralPK</span><span class="p">,</span> <span class="n">PK_i</span><span class="p">}</span>
<span class="n">ContainerCapsule_i</span> <span class="o">=</span> <span class="p">{</span><span class="n">KeyServerCapsuleID_i</span><span class="p">}</span>
<span class="n">EncryptedFMK_i</span> <span class="o">=</span> <span class="n">XOR</span><span class="p">(</span><span class="n">FMK</span><span class="p">,</span> <span class="n">KEK_i</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h4 id="decryption-steps-by-recipients_2"><span class="enumerate-headings-plugin enumerate-heading-plugin">4.6.1.2</span> Decryption steps by Recipients<a class="headerlink" href="#decryption-steps-by-recipients_2" title="Permanent link">¶</a></h4>
<p>Recipient <code>i</code> receives the CDOC2 <code>Container_i</code> with data <code>{C, EncryptedFMK_i, ContainerCapsule_i}</code> and has ECDSA public key <code>PK_i</code> and corresponding ECDSA secret key <code>SK_i</code>. Recipient reads <code>KeyServerCapsuleID_i</code> from <code>ContainerCapsule_i</code> and downloads corresponding <code>KeyServerCapsule_i</code> from Capsule Server.</p>
<p>Decryption steps are exactly the same:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">EncryptedFMK_i</span> <span class="o">=</span> <span class="n">Container_i</span><span class="o">.</span><span class="n">EncryptedFMK_i</span>
<span class="n">SenderEphemeralPK</span> <span class="o">=</span> <span class="n">KeyServerCapsule_i</span><span class="o">.</span><span class="n">EphemeralPK</span>
<span class="n">KEK_i</span> <span class="o">=</span> <span class="n">HKDF</span><span class="p">(</span><span class="n">StaticKEKSalt</span><span class="p">,</span> <span class="n">ECSVDP</span><span class="o">-</span><span class="n">DH</span><span class="p">(</span><span class="n">SK_i</span><span class="p">,</span> <span class="n">EphemeralPK</span><span class="p">))</span>
<span class="n">FMK</span> <span class="o">=</span> <span class="n">XOR</span><span class="p">(</span><span class="n">KEK_i</span><span class="p">,</span> <span class="n">EncryptedFMK_i</span><span class="p">)</span>
<span class="n">CEK</span> <span class="o">=</span> <span class="n">HKDF</span><span class="o">-</span><span class="n">Expand</span><span class="p">(</span><span class="n">FMK</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Dec</span><span class="p">(</span><span class="n">CEK</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h3 id="sc04-encryption-scheme-with-capsule-server-for-recipients-with-rsa-key-pairs"><span class="enumerate-headings-plugin enumerate-heading-plugin">4.6.2</span> SC04: Encryption scheme with Capsule Server for recipients with RSA key pairs<a class="headerlink" href="#sc04-encryption-scheme-with-capsule-server-for-recipients-with-rsa-key-pairs" title="Permanent link">¶</a></h3>
<p>This scheme uses same kind of RSA-OAEP encryption scheme, as <a href="#sc02-encryption-scheme-for-recipients-with-rsa-key-pair">scheme SC02</a>, but Capsule is transmitted via Capsule Server.</p>
<h4 id="encryption-steps-by-sender_3"><span class="enumerate-headings-plugin enumerate-heading-plugin">4.6.2.1</span> Encryption steps by Sender<a class="headerlink" href="#encryption-steps-by-sender_3" title="Permanent link">¶</a></h4>
<p>Sender knows the RSA public keys <code>PK_1</code>, <code>PK_2</code>, ..., <code>PK_l</code> of recipients <code>B_1</code>, <code>B_2</code>, ..., <code>B_l</code>. Recipients hold corresponding RSA secret keys <code>SK_1</code>, <code>SK_2</code>, ..., <code>SK_l</code>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">FMK</span> <span class="o">=</span> <span class="n">HKDF</span><span class="o">-</span><span class="n">Extract</span><span class="p">(</span><span class="n">StaticFMKSalt</span><span class="p">,</span> <span class="n">CSRNG</span><span class="p">())</span>
<span class="n">CEK</span> <span class="o">=</span> <span class="n">HKDF</span><span class="o">-</span><span class="n">Expand</span><span class="p">(</span><span class="n">FMK</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">Enc</span><span class="p">(</span><span class="n">CEK</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
<span class="n">KEK_i</span> <span class="o">=</span> <span class="n">CSRNG</span><span class="p">()</span>
<span class="n">EncryptedKEK_i</span> <span class="o">=</span> <span class="n">RSAES</span><span class="o">-</span><span class="n">OAEP</span><span class="o">-</span><span class="n">ENCRYPT</span><span class="p">(</span><span class="n">PK_i</span><span class="p">,</span> <span class="n">KEK_i</span><span class="p">)</span>
<span class="n">KeyServerCapsule_i</span> <span class="o">=</span> <span class="p">{{</span><span class="n">EncryptedKEK_i</span><span class="p">,</span> <span class="n">PK_i</span><span class="p">}</span>
<span class="n">ContainerCapsule_i</span> <span class="o">=</span> <span class="p">{</span><span class="n">KeyServerCapsuleID_i</span><span class="p">,</span> <span class="n">PK_i</span><span class="p">}</span>
<span class="n">EncryptedFMK_i</span> <span class="o">=</span> <span class="n">XOR</span><span class="p">(</span><span class="n">FMK</span><span class="p">,</span> <span class="n">KEK_i</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h4 id="decryption-steps-by-recipients_3"><span class="enumerate-headings-plugin enumerate-heading-plugin">4.6.2.2</span> Decryption steps by Recipients<a class="headerlink" href="#decryption-steps-by-recipients_3" title="Permanent link">¶</a></h4>
<p>Recipient <code>i</code> receives the CDOC2 <code>Container_i</code> with data <code>{C, EncryptedFMK_i, ContainerCapsule_i}</code> and has RSA public key <code>PK_i</code> and corresponding RSA secret key <code>SK_i</code>. Recipient reads <code>KeyServerCapsuleID_i</code> from <code>ContainerCapsule_i</code> and downloads corresponding <code>KeyServerCapsule_i</code> from Capsule server. Recipient authenticates to Capsule Server with RSA key pair <code>(SK_i, PK_i)</code>.</p>
<p>Decryption steps are exactly the same:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">EncryptedFMK_i</span> <span class="o">=</span> <span class="n">Container_i</span><span class="o">.</span><span class="n">EncryptedFMK</span>
<span class="n">EncryptedKEK_i</span> <span class="o">=</span> <span class="n">KeyServerCapsule_i</span><span class="o">.</span><span class="n">EncryptedKEK</span>
<span class="n">KEK_i</span> <span class="o">=</span> <span class="n">RSAES</span><span class="o">-</span><span class="n">OAEP</span><span class="o">-</span><span class="n">DECRYPT</span><span class="p">(</span><span class="n">SK_i</span><span class="p">,</span> <span class="n">EncryptedKEK_i</span><span class="p">)</span>
<span class="n">FMK</span> <span class="o">=</span> <span class="n">XOR</span><span class="p">(</span><span class="n">KEK_i</span><span class="p">,</span> <span class="n">EncryptedFMK_i</span><span class="p">)</span>
<span class="n">CEK</span> <span class="o">=</span> <span class="n">HKDF</span><span class="o">-</span><span class="n">Expand</span><span class="p">(</span><span class="n">FMK</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Dec</span><span class="p">(</span><span class="n">CEK</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h2 id="encryption-schemes-with-pre-shared-secrets"><span class="enumerate-headings-plugin enumerate-heading-plugin">4.7</span> Encryption schemes with pre-shared secrets<a class="headerlink" href="#encryption-schemes-with-pre-shared-secrets" title="Permanent link">¶</a></h2>
<p>Previous schemes SC01, SC02, SC03, and SC04 all use some form of pair-wise key-establishment protocols, and they are relying on the fact that recipients have access to RSA or EC key pairs, usually in the form of eID means. In addition to these schemes, CDOC2 system have to support situations, where Recipients don't have any such tokens, or when the storage requirements of CDOC2 Container exceed usable lifetime of such tokens. In these cases, it is possible to use pre-shared symmetric encryption key or pre-shared password.</p>
<h3 id="sc05-encryption-scheme-for-recipients-with-pre-shared-symmetric-secret"><span class="enumerate-headings-plugin enumerate-heading-plugin">4.7.1</span> SC05: Encryption scheme for recipients with pre-shared symmetric secret<a class="headerlink" href="#sc05-encryption-scheme-for-recipients-with-pre-shared-symmetric-secret" title="Permanent link">¶</a></h3>
<p>This scheme is used, when Sender wishes to use an externally generated symmetric encryption key for:</p>
<ul>
<li>long-term storage of CDOC2 Container, so that decryption of it doesn't depend on availability of hardware tokens or validity of PKI certificates, and/or</li>
<li>transmitting CDOC2 Container to such Receivers, who doesn't have any eID means, but who have previously received the symmetric encryption key.</li>
</ul>
<p>Encryption scheme can be used with multiple Recipients, who each may know different encryption key. This encryption scheme is very similar to <a href="./#sc06-direct-encryption-scheme-with-pre-shared-passwords">scheme SC06</a>, which uses pre-shared password or passphrase.</p>
<h4 id="encryption-steps-by-sender_4"><span class="enumerate-headings-plugin enumerate-heading-plugin">4.7.1.1</span> Encryption steps by Sender<a class="headerlink" href="#encryption-steps-by-sender_4" title="Permanent link">¶</a></h4>
<p>Sender knows symmetric keys <code>S_1</code>, <code>S_2</code>, ..., <code>S_l</code> for each Recipient <code>B_1</code>, <code>B_2</code>, ..., <code>B_l</code>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">FMK</span> <span class="o">=</span> <span class="n">HKDF</span><span class="o">-</span><span class="n">Extract</span><span class="p">(</span><span class="n">StaticFMKSalt</span><span class="p">,</span> <span class="n">CSRNG</span><span class="p">())</span>
<span class="n">CEK</span> <span class="o">=</span> <span class="n">HKDF</span><span class="o">-</span><span class="n">Expand</span><span class="p">(</span><span class="n">FMK</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">Enc</span><span class="p">(</span><span class="n">CEK</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
<span class="n">KeyMaterialSalt_i</span> <span class="o">=</span> <span class="n">CSRNG</span><span class="p">()</span>
<span class="n">KEK_i</span> <span class="o">=</span> <span class="n">HKDF</span><span class="p">(</span><span class="n">KeyMaterialSalt_i</span><span class="p">,</span> <span class="n">S_i</span><span class="p">)</span>
<span class="n">EncryptedKEK_i</span> <span class="o">=</span> <span class="n">Enc</span><span class="p">(</span><span class="n">S_i</span><span class="p">,</span> <span class="n">KEK_i</span><span class="p">)</span>
<span class="n">Capsule_i</span> <span class="o">=</span> <span class="p">{</span><span class="n">EncryptedKEK_i</span><span class="p">,</span> <span class="n">KeyMaterialSalt_i</span><span class="p">}</span>
<span class="n">EncryptedFMK_i</span> <span class="o">=</span> <span class="n">XOR</span><span class="p">(</span><span class="n">FMK</span><span class="p">,</span> <span class="n">KEK_i</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h4 id="decryption-steps-for-recipients-or-sender"><span class="enumerate-headings-plugin enumerate-heading-plugin">4.7.1.2</span> Decryption steps for Recipients or Sender<a class="headerlink" href="#decryption-steps-for-recipients-or-sender" title="Permanent link">¶</a></h4>
<p>Recipient <code>i</code> receives the CDOC2 <code>Container_i</code> with data <code>{C, EncryptedFMK_i, Capsule_i}</code> and knows symmetric key <code>S_i</code>. Also, Sender may assume the role of any Recipient <code>i</code>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">EncryptedKEK_i</span> <span class="o">=</span> <span class="n">Capsule_i</span><span class="o">.</span><span class="n">EncryptedKEK</span>
<span class="n">KeyMaterialSalt_i</span> <span class="o">=</span> <span class="n">Capsule_i</span><span class="o">.</span><span class="n">KeyMaterialSalt</span>
<span class="n">EncryptedFMK_i</span> <span class="o">=</span> <span class="n">Container_i</span><span class="o">.</span><span class="n">EncryptedFMK</span>
<span class="n">KEK_i</span> <span class="o">=</span> <span class="n">HKDF</span><span class="p">(</span><span class="n">KeyMaterialSalt_i</span><span class="p">,</span> <span class="n">S_i</span><span class="p">)</span>
<span class="n">FMK</span> <span class="o">=</span> <span class="n">XOR</span><span class="p">(</span><span class="n">KEK_i</span><span class="p">,</span> <span class="n">EncryptedFMK_i</span><span class="p">)</span>
<span class="n">CEK</span> <span class="o">=</span> <span class="n">HKDF</span><span class="o">-</span><span class="n">Expand</span><span class="p">(</span><span class="n">FMK</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Dec</span><span class="p">(</span><span class="n">CEK</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h3 id="sc06-direct-encryption-scheme-with-pre-shared-passwords"><span class="enumerate-headings-plugin enumerate-heading-plugin">4.7.2</span> SC06: Direct encryption scheme with pre-shared passwords<a class="headerlink" href="#sc06-direct-encryption-scheme-with-pre-shared-passwords" title="Permanent link">¶</a></h3>
<p>This scheme is used, when Sender wishes to use a password-based encryption for:</p>
<ul>
<li>long-term storage of CDOC2 Container, so that decryption of it doesn't depend on availability of hardware tokens or validity of PKI certificates, and/or</li>
<li>transmitting CDOC2 Container to such Receivers, who doesn't have any eID means.</li>
</ul>
<p>Password-based encryption scheme can be used with multiple Recipients, who each may know a different password for decryption. This encryption scheme is very similar to <a href="#sc05-encryption-scheme-for-recipients-with-pre-shared-symmetric-secret">scheme SC05</a>, which uses pre-shared encryption key(s).</p>
<h4 id="encryption-steps-by-sender_5"><span class="enumerate-headings-plugin enumerate-heading-plugin">4.7.2.1</span> Encryption steps by Sender<a class="headerlink" href="#encryption-steps-by-sender_5" title="Permanent link">¶</a></h4>
<p>Sender knows passwords <code>Password_1</code>, <code>Password_2</code>, ..., <code>Password_l</code> for each Recipient <code>B_1</code>, <code>B_2</code>, ..., <code>B_l</code> and follows steps for encryption:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">FMK</span> <span class="o">=</span> <span class="n">HKDF</span><span class="o">-</span><span class="n">Extract</span><span class="p">(</span><span class="n">StaticFMKSalt</span><span class="p">,</span> <span class="n">CSRNG</span><span class="p">())</span>
<span class="n">CEK</span> <span class="o">=</span> <span class="n">HKDF</span><span class="o">-</span><span class="n">Expand</span><span class="p">(</span><span class="n">FMK</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">Enc</span><span class="p">(</span><span class="n">CEK</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
<span class="n">PasswordSalt_i</span> <span class="o">=</span> <span class="n">CSRNG</span><span class="p">()</span>
<span class="n">PasswordKeyMaterial_i</span> <span class="o">=</span> <span class="n">PBKDF2</span><span class="p">(</span><span class="n">Password_i</span><span class="p">,</span> <span class="n">PasswordSalt_i</span><span class="p">)</span>
<span class="n">KeyMaterialSalt_i</span> <span class="o">=</span> <span class="n">CSRNG</span><span class="p">()</span>
<span class="n">KEK_i</span> <span class="o">=</span> <span class="n">HKDF</span><span class="p">(</span><span class="n">KeyMaterialSalt_i</span><span class="p">,</span> <span class="n">PasswordKeyMaterial_i</span><span class="p">)</span>
<span class="n">Capsule_i</span> <span class="o">=</span> <span class="p">{</span><span class="n">KeyMaterialSalt_i</span><span class="p">,</span> <span class="n">PasswordSalt_i</span><span class="p">}</span>
<span class="n">EncryptedFMK_i</span> <span class="o">=</span> <span class="n">XOR</span><span class="p">(</span><span class="n">FMK</span><span class="p">,</span> <span class="n">KEK_i</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>Sender creates a CDOC2 Container for each Recipient with <code>{C, EncryptedFMK_i, Capsule_i}</code>, including other technical details, and sends the Container to Recipient or places in long-term storage for themselves.</p>
<h4 id="decryption-steps-for-recipient-or-sender"><span class="enumerate-headings-plugin enumerate-heading-plugin">4.7.2.2</span> Decryption steps for Recipient or Sender<a class="headerlink" href="#decryption-steps-for-recipient-or-sender" title="Permanent link">¶</a></h4>
<p>After some time, Sender may wish to decrypt the Container themselves (assuming the role of any Recipient <code>i</code>) or the Recipient <code>i</code> wishes to decrypt the Container.</p>
<p>Recipient <code>i</code> receives CDOC2 <code>Container_i</code> with data <code>{C, EncryptedFMK, Capsule}</code> and has password <code>Password_i</code> and follows steps for decryption:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">PasswordSalt_i</span> <span class="o">=</span> <span class="n">Capsule_i</span><span class="o">.</span><span class="n">PasswordSalt</span>
<span class="n">PasswordKeyMaterial_i</span> <span class="o">=</span> <span class="n">PBKDF2</span><span class="p">(</span><span class="n">Password_i</span><span class="p">,</span> <span class="n">PasswordSalt_i</span><span class="p">)</span>
<span class="n">KeyMaterialSalt_i</span> <span class="o">=</span> <span class="n">Capsule_i</span><span class="o">.</span><span class="n">KeyMaterialSalt</span>
<span class="n">EncryptedFMK_i</span> <span class="o">=</span> <span class="n">Container_i</span><span class="o">.</span><span class="n">EncryptedFMK</span>
<span class="n">KEK_i</span> <span class="o">=</span> <span class="n">HKDF</span><span class="p">(</span><span class="n">KeyMaterialSalt_i</span><span class="p">,</span> <span class="n">PasswordKeyMaterial_i</span><span class="p">)</span>
<span class="n">FMK</span> <span class="o">=</span> <span class="n">XOR</span><span class="p">(</span><span class="n">KEK_i</span><span class="p">,</span> <span class="n">EncryptedFMK_i</span><span class="p">)</span>
<span class="n">CEK</span> <span class="o">=</span> <span class="n">HKDF</span><span class="o">-</span><span class="n">Expand</span><span class="p">(</span><span class="n">FMK</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Dec</span><span class="p">(</span><span class="n">CEK</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h2 id="encryption-schemes-with-secret-sharing"><span class="enumerate-headings-plugin enumerate-heading-plugin">4.8</span> Encryption schemes with secret sharing<a class="headerlink" href="#encryption-schemes-with-secret-sharing" title="Permanent link">¶</a></h2>
<h3 id="sc07-encryption-scheme-with-n-of-n-secret-shared-decryption-key"><span class="enumerate-headings-plugin enumerate-heading-plugin">4.8.1</span> SC07: Encryption scheme with (n-of-n) secret shared decryption key<a class="headerlink" href="#sc07-encryption-scheme-with-n-of-n-secret-shared-decryption-key" title="Permanent link">¶</a></h3>
<p>This scheme is used, when Sender wishes to allow decrypting CDOC2 documents using authentication means like Smart-ID/Mobile-ID. In that case, multiple CDOC2 Shares Servers (CSS) are used to distribute the key material necessary to decrypt CDOC2 Container among the servers and this way to reduce the need to trust a single CSS server. Scheme uses simple n-of-n solution, where recipient needs to download all <code>n</code> shares in order to reconstruct the key material.</p>
<h4 id="encryption-steps-by-sender_6"><span class="enumerate-headings-plugin enumerate-heading-plugin">4.8.1.1</span> Encryption steps by Sender<a class="headerlink" href="#encryption-steps-by-sender_6" title="Permanent link">¶</a></h4>
<p>Following steps outline how to create CDOC2 Container with a Recipient header structure and a Capsule for Recipient <code>i</code>. Index <code>i</code> is for enumerating over Recipients from <code>(1, 2, 3, ..., l)</code>. Index <code>j</code> is for enumerating over shares from <code>(1, 2, 3, ..., n)</code> of <code>KEK_i</code>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">FMK</span> <span class="o">=</span> <span class="n">HKDF_Extract</span><span class="p">(</span><span class="n">Static_FMK_Salt</span><span class="p">,</span> <span class="n">CSRNG</span><span class="p">())</span>
<span class="n">CEK</span> <span class="o">=</span> <span class="n">HKDF_Expand</span><span class="p">(</span><span class="n">FMK</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">Enc</span><span class="p">(</span><span class="n">CEK</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">...</span> <span class="n">l</span><span class="p">):</span> 
   <span class="n">KeyMaterialSalt_i</span> <span class="o">=</span> <span class="n">CSRNG</span><span class="p">()</span>
   <span class="n">KEK_i</span> <span class="o">=</span> <span class="n">HKDF_Expand</span><span class="p">(</span><span class="n">HKDF_Extract</span><span class="p">(</span><span class="n">KeyMaterialSalt_i</span><span class="p">,</span> <span class="n">CSRNG</span><span class="p">()))</span>
   <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
      <span class="n">KEK_i_share_j</span> <span class="o">=</span> <span class="n">CSRNG</span><span class="p">()</span> 
   <span class="n">KEK_i_share_1</span> <span class="o">=</span> <span class="n">XOR</span><span class="p">(</span><span class="n">KEK_i</span><span class="p">,</span> <span class="n">KEK_i_share_2</span><span class="p">,</span> <span class="n">KEK_i_share_3</span><span class="p">,</span><span class="o">...</span><span class="p">,</span> <span class="n">KEK_i_share_n</span><span class="p">)</span>
   <span class="c1"># Client uploads all shares of KEK_i to CSS servers and </span>
   <span class="c1"># gets corresponding Capsule_i_Share_j_ID for each KEK_i_share_j</span>
   <span class="n">RecipientInfo_i</span> <span class="o">=</span> <span class="s2">"etsi/PNOEE-48010010101"</span>
   <span class="n">DistributedKEKInfo_i</span> <span class="o">=</span> <span class="p">{</span><span class="n">CSS_ID</span><span class="p">,</span> <span class="n">Capsule_i_Share_j_ID</span><span class="p">}</span>
   <span class="n">Capsule_i</span> <span class="o">=</span> <span class="p">{</span><span class="n">RecipientInfo_i</span><span class="p">,</span> <span class="n">DistributedKEKInfo_i</span><span class="p">}</span>
   <span class="n">EncryptedFMK_i</span> <span class="o">=</span> <span class="n">XOR</span><span class="p">(</span><span class="n">FMK</span><span class="p">,</span> <span class="n">KEK_i</span><span class="p">)</span>

<span class="n">Container</span> <span class="o">=</span> <span class="p">{</span><span class="n">C</span><span class="p">,</span> <span class="n">EncryptedFMK_i</span> <span class="p">[</span><span class="mf">1.</span><span class="o">.</span><span class="n">l</span><span class="p">],</span> <span class="n">Capsule_i</span> <span class="p">[</span><span class="mf">1.</span><span class="o">.</span><span class="n">l</span><span class="p">]}</span>
</code></pre></div></td></tr></table></div>
<p>Sender has created a CDOC2 Container containing <code>{C, EncryptedFMK_i [1..l], Capsule_i [1..l]}</code> for transmitting to Recipients <code>(1..l)</code>.</p>
<h4 id="decryption-steps-by-recipient"><span class="enumerate-headings-plugin enumerate-heading-plugin">4.8.1.2</span> Decryption steps by Recipient<a class="headerlink" href="#decryption-steps-by-recipient" title="Permanent link">¶</a></h4>
<p>Recipient <code>i</code> receives a CDOC2 Container containing <code>{C, EncryptedFMK_i [1..l], Capsule_i [1..l]}</code>, where <code>Capsule_i = {RecipientInfo_i, DistributedKEKInfo_i}</code> and <code>DistributedKEKInfo_i = {CSS_ID, Capsule_i_Share_j_ID} [1..n]</code>.</p>
<p>Authentication signature data format and authentication token details are specified in section <a href="../../03_system_architecture/ch04_capsule_server/">Capsule Server</a>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Recipient sends `Capsule_i_Share_j_ID` to corresponding CSS servers</span>
<span class="c1"># and receives `nonce_i_j` from each server</span>
<span class="n">auth_data</span> <span class="o">=</span> <span class="p">{</span><span class="n">Capsule_i_Share_j_ID</span><span class="p">,</span> <span class="n">SHA256</span><span class="p">(</span><span class="n">nonce_i_j</span><span class="p">)}</span>
<span class="n">auth_hash</span> <span class="o">=</span> <span class="n">SHA256</span><span class="p">(</span><span class="n">auth_data</span><span class="p">)</span>
<span class="c1"># Recipient performs ID-card/Mobile-ID/Smart-ID authentication</span>
<span class="c1"># and creates a signature `auth_signature` on `auth_hash` </span>
<span class="c1"># with authentication key pair.</span>
<span class="n">auth_signature</span> <span class="o">=</span> <span class="n">sign</span><span class="p">(</span><span class="n">auth_hash</span><span class="p">)</span> 
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">...</span> <span class="n">n</span><span class="p">]:</span> 
   <span class="n">auth_token_j</span> <span class="o">=</span> <span class="n">auth_data_for_server_j</span> <span class="o">+</span> <span class="n">auth_signature</span>
<span class="n">KEK_i</span> <span class="o">=</span> <span class="n">XOR</span><span class="p">(</span><span class="n">KEK_i_share_1</span><span class="p">,</span> <span class="n">KEK_i_share_2</span><span class="p">,</span> <span class="n">KEK_i_share_3</span><span class="p">,</span><span class="o">...</span><span class="p">,</span> <span class="n">KEK_i_share_n</span><span class="p">)</span>
<span class="n">FMK</span> <span class="o">=</span> <span class="n">XOR</span><span class="p">(</span><span class="n">KEK_i</span><span class="p">,</span> <span class="n">EncryptedFMK_i</span><span class="p">)</span>
<span class="n">CEK</span> <span class="o">=</span> <span class="n">HKDF_Expand</span><span class="p">(</span><span class="n">FMK</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Dec</span><span class="p">(</span><span class="n">CEK</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
</main>
<footer class="md-footer">
<nav aria-label="Footer" class="md-footer__inner md-grid">
<a aria-label="Previous: Use Cases" class="md-footer__link md-footer__link--prev" href="../../01_use_case_model/ch03_use_cases/">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</div>
<div class="md-footer__title">
<span class="md-footer__direction">
                Previous
              </span>
<div class="md-ellipsis">
                Use Cases
              </div>
</div>
</a>
<a aria-label="Next: Container Format" class="md-footer__link md-footer__link--next" href="../ch03_container_format/">
<div class="md-footer__title">
<span class="md-footer__direction">
                Next
              </span>
<div class="md-ellipsis">
                Container Format
              </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.footer", "navigation.expand", "content.tooltips", "toc.follow"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
<script src="../../assets/javascripts/bundle.60a45f97.min.js"></script>
<script src="../../javascripts/katex.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/contrib/auto-render.min.js"></script>
</body>
</html>