image: python:3.8-buster

before_script:
  - pip install -r mkdocs_requirements.txt

pages:
  stage: deploy
  rules:
    - if: '$CI_PIPELINE_SOURCE == "merge_request_event" && $CI_MERGE_REQUEST_TARGET_BRANCH_NAME == "master"'
  script:
    - cd cdoc2-system-docs && mkdocs build --strict --verbose --site-dir public
  artifacts:
    paths:
    - cdoc2-system-docs/public
  publish: cdoc2-system-docs/public